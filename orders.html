<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>طلبات العملاء</title>
  <style>
    body { font-family: Arial, sans-serif; direction: rtl; background: #f5f5f5; }
    .container { max-width: 800px; margin: 20px auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .order { border-bottom: 1px solid #ccc; padding: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <h2>جميع الطلبات</h2>
    <div id="orders-container"></div>
  </div>

  <script>
    function fetchOrders() {
      fetch("https://adpl-orders-default-rtdb.firebaseio.com/")
        .then(response => response.json())
        .then(data => {
          const container = document.getElementById("orders-container");
          container.innerHTML = "";
          if (!data) {
            container.innerHTML = "<p>لا توجد طلبات حتى الآن</p>";
            return;
          }
          
          Object.keys(data).forEach(key => {
            const order = data[key];
            const productsList = order.products.map(p => `<li>${p.name} × ${p.quantity}</li>`).join("");
            container.innerHTML += `
              <div class="order">
                <p><strong>رقم الطلب:</strong> ${order.orderNumber}</p>
                <p><strong>المستخدم:</strong> ${order.user ? order.user.username : "غير معروف"}</p>
                <p><strong>التاريخ:</strong> ${new Date(order.date).toLocaleString()}</p>
                <p><strong>المنتجات:</strong></p>
                <ul>${productsList}</ul>
              </div>
            `;
          });
        })
        .catch(error => console.error("خطأ أثناء جلب الطلبات:", error));
    }

    fetchOrders();
    setInterval(fetchOrders, 5000); // تحديث الطلبات كل 5 ثوانٍ
  </script>
</body>
</html>
